# Snapshot: ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Phase 6 - Video Pipeline Restoration v3.0)

**Time**: 2026-01-14 14:18
**Context**: ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô Video Pipeline ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå UI Snapshots ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∏‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (v2.0 failure)

## üìå ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ú‡∏ô 3 Phases (The Final Push)

### Phase 1: Selector Sync & Targeted Interactions (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á UI)
**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ Script "‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô" ‡πÅ‡∏•‡∏∞ "‡∏Ñ‡∏•‡∏¥‡∏Å" ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- **Action 1.1**: ‡∏õ‡∏£‡∏±‡∏ö `VideoService.configureVideoSettings` ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Selector ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Image Flow (‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ `:has-text` ‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏á)
- **Action 1.2**: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Logic ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î (`+`) ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ü‡∏£‡∏° ‡πÇ‡∏î‡∏¢‡∏´‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà **‡∏Ç‡πâ‡∏≤‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏•‡∏±‡∏ö (swap_horiz)** ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° Upload ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏™‡∏µ‡πà‡∏™‡∏∏‡πà‡∏°‡∏´‡πâ‡∏≤
- **Action 1.3**: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≠ (Safety Wait) ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Model ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ UI ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û

### Phase 2: Data Integrity & Prompt Serialization
**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Flow
- **Action 2.1**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• `generatedImageUrl` ‡πÉ‡∏ô `FILL_IMAGES` ‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ Character (Product Image)
- **Action 2.2**: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `handleFillPrompt` ‡πÉ‡∏ô `shared-handlers.js` ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô `JSON.stringify(videoPrompt)` ‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏•‡∏á‡πÑ‡∏õ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Google Flow ‡∏£‡∏±‡∏ö Prompt ‡∏Å‡πâ‡∏≠‡∏ô JSON ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

### Phase 3: Loop Stabilization & Verification
**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏á‡πÇ‡∏Ñ‡∏à‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô (Infinite Retry)
- **Action 3.1**: ‡πÄ‡∏û‡∏¥‡πà‡∏° Checkpoint ‡πÉ‡∏ô `uploadImageViaAddButton` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏£‡∏π‡∏õ‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Slot ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á "‡∏Å‡πà‡∏≠‡∏ô" ‡∏à‡∏∞‡∏™‡∏±‡πà‡∏á Retry
- **Action 3.2**: ‡πÄ‡∏û‡∏¥‡πà‡∏° Logs ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏π‡∏á (Trace Logs) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Real-time ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î‡∏≠‡∏µ‡∏Å

---

## üõ†Ô∏è Files to be Modified
1. `projects/tiktok-shop-automation/features/google-flow/services/video-gen.js` (Selectors & Settings)
2. `projects/tiktok-shop-automation/features/google-flow/core/shared-handlers.js` (Prompt Logic & Data Flow)
3. `projects/tiktok-shop-automation/features/google-flow/flow-content-script.js` (Targeted Clicking & Polling)

## üõ°Ô∏è Risk Mitigation
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á | ‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô |
| :--- | :--- |
| ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡∏±‡∏ß (Positional Collision) | ‡πÉ‡∏ä‡πâ Selector ‡∏ó‡∏µ‡πà‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å `i.material-symbols-outlined` ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ô |
| Prompt ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô JSON | ‡πÉ‡∏ä‡πâ `try-catch` ‡πÅ‡∏•‡∏∞ `JSON.stringify` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö Format |
| ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ã‡πâ‡∏≥ (Multiple Uploads) | ‡πÄ‡∏û‡∏¥‡πà‡∏° Flag ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ `isUploading` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô |

---

**Before we proceed:**
- ‡πÅ‡∏ú‡∏ô 3 Phases ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏û‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
- ‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏ú‡∏°‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏° Phase 1 ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö

Ready to start?
